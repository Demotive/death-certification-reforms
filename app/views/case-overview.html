{% extends '_layouts/admin.html' %}

{% block content %}
  <div class="section">
    <div class="breadcrumb">
      <ul>
        <li><a href="/cases">Cases</a></li>
        <li>{{ session.caseRef }}</li>
      </ul>
    </div>
  </div>

  <div class="section">
    <h1 class="bold-large">
      {{ session.caseRef }}
      <a href="/rename-case" class="font-xxsmall">Rename</a>
    </h1>
  </div>

  <div class="section floats bordered">
    <div class="case-status shunt-small">
      <h2 class="font-xsmall shunt-tiny">Status:
        {% set status = 'new' %}
        <span class="status-{{ status }}">{{ session.caseStatus }}</span>
      </h2>
      <ul>
        <li>
          <span>ME scrutiny</span>
        </li>
        <li>
          <span>External examination</span>
        </li>
        <li>
          <span>QAP and ME discussion</span>
        </li>
        <li>
          <span>ME signed off cause of death</span>
        </li>
        <li>
          <span>Discussion with informant</span>
        </li>
        <li>
          <span>Informant assent</span>
        </li>
      </ul>
    </div>
    <div class="shunt-tiny">
      <div class="font-xxsmall shunt-tiny">Edited</div>
      {{ session.modificationTimestamp | date('D MMMM YYYY [ at ] HH:mm') }}
    </div>
    <div class="shunt-tiny">
      <div class="font-xxsmall shunt-tiny">Created</div>
      {{ session.caseCreated | date('D MMMM YYYY [ at ] HH:mm') }}
    </div>
  </div>

  <div class="grid">

    <div class="panel-3-up">
      <h3 class="shunt-small">
        {% if session.deceased %}
          {% set url = '/details-deceased' %}
        {% else %}
          {% set url = '/edit-deceased' %}
        {% endif %}
        <a href="{{ url }}" class="font-small">
          Deceased
          {% if session.deceased %}
            <div class="bold-medium">
              {% if session.deceased['name'] %}
                {{ session.deceased['name'] }}
              {% else %}
                <span class="not-set">Name not yet added</span>
              {% endif %}
            </div>
          {% endif %}
        </a>
      </h3>
      {% if session.deceased %}
        <table>
          <tr>
            <th scope="row">Died:</th>
            <td>
              {% if session.deceased['deathTimestamp'] %}
                {{ session.deceased['deathTimestamp'] | date("DD MMMM YYYY") }} at {{ session.deceased['deathTimestamp'] | date("HH[:]mm") }}
              {% else %}
                <span class="not-set">Not yet added</span>
              {% endif %}
            </td>
          </tr>
          <tr>
            <th scope="row">Age:</th>
            <td>
              {% if session.deceased['age'] %}
                {{ session.deceased['age'] }}
              {% else %}
                <span class="not-set">Not yet added</span>
              {% endif %}
            </td>
          </tr>
          <tr>
            <th scope="row">Type:</th>
            <td>
              {% if session.deceased['type-group'] %}
                {{ session.deceased['type-group'] | capitalize }}
              {% else %}
                <span class="not-set">Not yet added</span>
              {% endif %}
            </td>
          </tr>
          <tr>
            <th scope="row">Cause:</th>
            <td><a href="#">cause not added</a></td>
          </tr>
        </table>
      {% else %}
        No details yet.
        <a href="/edit-deceased">Add details</a>
      {% endif %}
    </div>

    <div class="panel-3-up">
      <h3 class="shunt-small">
        <a href="#" class="font-small">Events</a>
      </h3>
      No events yet.
      <a href="#">Add event</a>
    </div>

    <div class="panel-3-up">
      <h3 class="shunt-small">
        {% if session.contacts.length > 0 %}
          {% set url = '/contacts' %}
        {% else %}
          {% set url = '/add-contact' %}
        {% endif %}
        <a href="{{ url }}" class="font-small">Contacts</a>
      </h3>
      {% if session.contacts.length > 0 %}
        {% for contact in session.contacts %}
          <div class="shunt-medium">
            <h5 class="font-xxsmall shunt-tiny">
              {{ contact['role'] | capitalize }}<br>
              <div class="bold-medium">
                <a href="/details-contact-examination/{{ contact['url-name'] }}">{{ contact['name'] }}</a>
              </div>
            </h5>
            <div class="shunt-tiny">
              {% for item in contact['methods'] %}
                {% if item['name'] == contact['primary-channel'] %}
                  {{ item['value'] }}
                {% endif %}
              {% endfor %}
            </div>
            <div class="shunt-tiny">
              <a href="/details-contact-examination/{{ contact['url-name'] }}">Full contact details</a>
            </div>
          </div>
        {% endfor %}
      {% else %}
        No contacts assigned yet.
        <a href="/add-contact">Add contacts</a>
      {% endif %}
      <!--
      <div class="shunt-medium">
        <h5 class="shunt-tiny">
          Informant<br>
          <div class="bold-medium">Charles McNulty</div>
        </h5>
        Best contact: informant@personalemail.co.uk
        <div class="shunt-tiny">
          <a href="#">Full contact details</a>
        </div>
      </div>
      <div class="shunt-medium">
        <a href="#">James McNulty, son</a>
      </div>
      -->
    </div>

  </div>
{% endblock %}
